apply plugin: 'java'

sourceCompatibility = 1.6
version = '0.1.0'

repositories {
    mavenCentral()
}

dependencies {
	//compile group: "org.slf4j", name: "slf4j-api", version: "1.7.7"
    //compile group: "ch.qos.logback", name: "logback-classic", version: versions.logback

    compile group: "org.antlr", name: "antlr4-runtime", version: "4.3"
    compile group: "org.antlr", name: "antlr4", version: "4.3"
    //compile group: "com.intellij", name: "annotations", version: "12.0"

    testCompile group: "junit", name: "junit", version: "4.11"
}

task genGrammar(type: JavaExec) {
	

	def dir = 'src/main/java/com/hwwu/lamlite/parser'


	def grammars = fileTree(dir).include('**/*.g4')
	description = 'Generating parsers for ' + grammars.files

	inputs.file grammars.files
	outputs.dir file(dir)
	main = 'org.antlr.v4.Tool'
	classpath = configurations.compile
	args = ["-o", dir, "-listener", "-visitor", "-package", "com.hwwu.lamlite.parser", grammars.files.join(" ")]
}

task wrapper(type: Wrapper) {
	gradleVersion = '2.0'
}


compileJava.dependsOn genGrammar 
